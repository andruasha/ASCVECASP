# Документация к классу CircuitVisualize

## Импортируемые модули

- `matplotlib.pyplot`: используется для построения графика схемы.
- Из `src.common.draw_functions` импортированы функции для отрисовки различных элементов схемы:
  - `draw_voltage_source`
  - `draw_current_source`
  - `draw_resistor`
  - `draw_capacitor`
  - `draw_inductor`
  - `draw_active_dipole`
  - `draw_switch`
- `SCALE` из `conf.config`: минимальный размер линии, необходимый для размещения элемента.

---

## Класс: `CircuitVisualize`

Предназначен для визуализации электрической схемы на плоскости.

### `__init__(self, circuit, circuit_topology)`
**Параметры:**
- `circuit`: объект схемы, содержащий данные о расположении и соединениях элементов.
- `circuit_topology`: объект, содержащий координаты узлов схемы.

---

### `visualize(self)`

Визуализирует схему с помощью `matplotlib`.

**Основные действия:**
1. Настраивает поле графика (сетка, лимиты, масштаб).
2. Отображает узлы схемы в виде точек.
3. Отображает соединения между узлами как линии.
4. Размещает элементы (резисторы, источники, индуктивности и др.) вдоль доступных линий (`free_lines`) с учётом направления (горизонтально или вертикально).
5. Обрабатывает как одиночные линии, так и случаи с несколькими подходящими линиями (делит элементы между ними).

**Возвращает:**
- Объект `matplotlib.pyplot`, содержащий визуализацию схемы.

---

### `get_free_lines(self, target_segment)`

Определяет, какие отрезки (`lines`) в сегменте соединений свободны для размещения элементов.

**Аргументы:**
- `target_segment`: список координат точек соединения, для которых нужно найти свободные линии.

**Внутренние функции:**
- `is_point_on_segment(p, a, b)`: проверяет, лежит ли точка `p` на отрезке `ab`.
- `is_line_nested(inner_line, outer_line)`: проверяет, вложена ли одна линия в другую (т.е. пересекаются или совпадают).

**Возвращает:**
- Список пар координат (линий), свободных для размещения элементов.

---

## Поддерживаемые элементы схемы:

- `voltage_source` — источник напряжения
- `current_source` — источник тока
- `resistor` — резистор
- `capacitor` — конденсатор
- `inductor` — индуктивность
- `active_dipole` — активный диполь
- `opening_switch`, `closing_switch` — размыкающий/замыкающий переключатель

Элементы автоматически индексируются (R1, C1, L1, V1 и т.д.) в порядке размещения.

---

## Пример использования:

```python
visualizer = CircuitVisualize(circuit, circuit_topology)
plot = visualizer.visualize()
plot.show()
```
# Документация к классу ElectricCircuit

## Импортируемые модули

- `copy`: используется для глубокого копирования структуры соединений.
- `secrets`: генерация криптостойких случайных значений.
- `matplotlib.pyplot`: визуализация электрической схемы.
- `itertools.combinations`: генерация всех возможных пар узлов.
- `conf.config.SCALE`, `conf.config.SCALE_RATIO`: масштабные коэффициенты, определяющие шаги и границы на сетке.

---

## Функции

### `get_random_elements(elements_array, elements_num)`
Возвращает случайный поднабор из `elements_num` элементов из списка `elements_array`.

---

## Класс `ElectricCircuit`

### `__init__(self, branches_num, nodes)`
Инициализирует объект электрической схемы:
- `branches_num` — количество соединений (ветвей), которые должны быть созданы.
- `nodes` — словарь узлов с их координатами.

---

### `find_near_node(self, nodes)`
Ищет соседние узлы в четырех направлениях (вверх, вниз, влево, вправо) от заданного узла.

---

### `create_nodes_connections(self)`
Создаёт все возможные соединения между узлами на основе их расположения:
1. Прямые соединения между ближайшими соседями.
2. Диагональные соединения при отсутствии пересечений.
3. Добавляет случайные соединения, пока не будет достигнуто нужное количество ветвей (`branches_num`), при этом не допускает более 2 соединений между одной парой узлов.
4. Проверяет, чтобы у каждого узла было минимум 3 соединения.

---

### `get_num_connections_between_nodes(self, node1_name, node2_name)`
Возвращает количество соединений между двумя заданными узлами.

---

### `count_node_connections(self, node_name)`
Подсчитывает, сколько соединений связано с заданным узлом.

---

### `visualise_circuit(self)`
Отображает схему с помощью `matplotlib`. Отрисовывает:
- Узлы — в виде черных точек.
- Соединения — в виде линий между координатами.

---

### `find_bounds(self)`
Возвращает границы (левую, правую, верхнюю и нижнюю) текущей схемы на основе всех точек соединений.

---

### `check_node_type(self, checking_node_coords)`
Определяет тип узла в зависимости от его положения на границе схемы (например: `upper_right`, `bottom_left` и т.д.).

---

### `connect_two_nodes(self, node1, node2)`
Создаёт соединение между двумя узлами в зависимости от их расположения:
- Прямое соединение по вертикали или горизонтали.
- Обходное соединение с использованием дополнительных промежуточных точек, если прямое невозможно.
- Учитываются границы схемы и тип узлов.

---

## Важные переменные

- `self.nodes`: словарь узлов и их координат.
- `self.nodes_connections`: словарь всех соединений. Ключ — строка `"A->B"`, значение — список маршрутов (каждый маршрут — список точек).

---

## Пример использования

```python
nodes = {
    "A": {"x": 0, "y": 0},
    "B": {"x": 1, "y": 0},
    "C": {"x": 1, "y": 1},
    "D": {"x": 0, "y": 1},
}

circuit = ElectricCircuit(branches_num=4, nodes=nodes)
circuit.create_nodes_connections()
circuit.visualise_circuit()
```
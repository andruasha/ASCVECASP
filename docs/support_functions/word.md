# Документация к модулю генерации схем в Word

## Назначение
Модуль предназначен для создания документа Word (.docx) с таблицей вариантов схем, их изображениями и параметрами элементов.

## Зависимости
- Python 3.x
- Библиотеки:
  ```python
  import random
  import os
  from docx import Document
  from docx.shared import Inches, Pt
  from docx.enum.text import WD_ALIGN_PARAGRAPH
  from PIL import Image
  ```
- Конфигурационный файл `conf/config.py` должен содержать:
  ```python
  IMAGES_FOLDER = "images"  # Папка с изображениями схем
  DOCX_NAME = "schemes.docx"  # Имя генерируемого файла
  ```

## Основные функции

### `add_schemes_to_word(scheme_type, save_path)`
Главная функция модуля, создающая документ Word с таблицей схем.

**Параметры:**
- `scheme_type` (str): Тип схемы (может влиять на генерируемые параметры)
  - Допустимые значения: `"alternating_current"`, `"transient_processes"`, `"coupling_coefficient"`
- `save_path` (str): Путь для сохранения итогового документа

**Константы модуля:**
```python
MAX_IMAGE_WIDTH_INCHES = 3  # Максимальная ширина изображения в дюймах
NUMBER_COL_WIDTH = Inches(0.8)  # Ширина колонки с номерами вариантов
```

## Логика работы

1. Создается новый документ Word с настройками стиля:
   - Шрифт: Times New Roman
   - Размер: 13 pt

2. Создается таблица с 3 колонками:
   - "Номер варианта"
   - "Схема" (для изображений)
   - "Номиналы" (параметры элементов)

3. Для каждого из 30 вариантов:
   - Добавляется строка в таблицу
   - Загружается изображение схемы (если существует)
   - Из метаданных изображения извлекаются параметры элементов
   - В зависимости от типа схемы генерируются дополнительные параметры
   - Форматируется текст в ячейках

4. Документ сохраняется по указанному пути

## Формат изображений схем
- Изображения должны быть в формате PNG
- Должны располагаться в папке `IMAGES_FOLDER` (из конфига)
- Имена файлов: `scheme_1.png`, `scheme_2.png`, ..., `scheme_30.png`
- Метаданные изображения должны содержать параметры элементов:
  ```python
  {
      'V1': '5V',  # Напряжение
      'I1': '0.5A',  # Ток
      'R1': '10k',  # Резистор
      'C1': '100nF',  # Конденсатор
      'L1': '10mH',  # Катушка индуктивности
      'switch_info': 'opening'  # Опционально: состояние ключа
  }
  ```

## Пример использования
```python
add_schemes_to_word(
    scheme_type="alternating_current",
    save_path="C:/Documents/Schemes"
)
```

## Генерируемые параметры
В зависимости от типа схемы автоматически добавляются:
- Для `alternating_current` и `transient_processes` - случайная частота (1-20 кГц)
- Для `coupling_coefficient` - задание на расчет коэффициента связи
- При наличии `switch_info` - информация о состоянии ключа

## Форматирование выходного документа
- Все ячейки таблицы используют шрифт Times New Roman 13pt
- Номера вариантов выравниваются по центру
- Изображения масштабируются, чтобы не превышать `MAX_IMAGE_WIDTH_INCHES`